<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Padhendoet Streetfood ‚Äì Cemilan Kekinian</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');

        :root {
            --primary: #ff6b35;
            --secondary: #ff8e53;
            --accent: #ffa366;
            --dark: #2c1810;
            --darker: #1a0f08;
            --light: #fff5f0;
            --white: #ffffff;
            --green: #25d366;
            --shadow: rgba(255, 107, 53, 0.3);
            --shadow-dark: rgba(44, 24, 16, 0.2);
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', system-ui, Arial, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--darker) 100%);
            background-attachment: fixed;
            color: var(--dark);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* NAVBAR */
        nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        nav .brand {
            font-weight: 800;
            font-size: 24px;
            background: linear-gradient(45deg, #fff, var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        nav .menu {
            display: flex;
            gap: 30px;
        }

        nav .menu a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            padding: 8px 16px;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        /* HEADER */
        header.hero {
            background: url('img/banner.jpg') center/cover no-repeat;
            position: relative;
            min-height: 70vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
        }

        header.hero::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: 0;
        }

        header.hero h1,
        header.hero p,
        header.hero .cta-btn {
            position: relative;
            z-index: 1;
        }

        header.hero h1 {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #fff, #ffcc88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header.hero p {
            font-size: 18px;
            color: #f8f8f8;
            max-width: 600px;
            margin: 0 auto;
        }

        .hero .cta-btn {
            display: inline-block;
            margin-top: 25px;
            padding: 14px 32px;
            font-size: 16px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 40px;
            text-decoration: none;
        }

        /* CONTAINER */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .section-title {
            text-align: center;
            margin-bottom: 50px;
            color: white;
        }

        .section-title h2 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #fff, var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-title p {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* PRODUCTS GRID */
        .products {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 25px;
            box-shadow:
                0 10px 40px rgba(44, 24, 16, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }

        .card h3 {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card p {
            font-size: 14px;
            color: var(--dark);
            opacity: 0.8;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .price {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* BUTTONS */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: linear-gradient(135deg, var(--green) 0%, #20b358 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .btn.secondary {
            background: linear-gradient(135deg, #fff 0%, #fff 100%);
            color: var(--dark);
            border: 1px solid rgba(0,0,0,0.06);
        }

        /* CART FLOAT BUTTON */
        .cart-fab {
            position: fixed;
            right: 25px;
            bottom: 25px;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            cursor: pointer;
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
        }

        .cart-count {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #fff;
            color: var(--primary);
            font-weight: 700;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            border: 3px solid rgba(255,255,255,0.2);
        }

        /* CART MODAL */
        .modal {
            position: fixed;
            right: 20px;
            bottom: 100px;
            width: 380px;
            max-width: 95vw;
            background: rgba(255,255,255,0.98);
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            z-index: 2100;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .modal header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 16px;
            font-weight: 700;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal .content {
            padding: 16px;
            max-height: 420px;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 12px;
        }

        .cart-item img {
            width: 64px;
            height: 64px;
            object-fit: cover;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.06);
        }

        .cart-item .meta {
            flex: 1;
            font-size: 14px;
        }

        .cart-item .meta b {
            display: block;
            margin-bottom: 6px;
            color: var(--dark);
        }

        .cart-item .actions {
            display: flex;
            flex-direction: column;
            gap: 6px;
            align-items: flex-end;
        }

        .qty-control {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .qty-control button {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            border: 1px solid rgba(0,0,0,0.06);
            background: white;
            cursor: pointer;
        }

        .modal footer {
            padding: 16px;
            border-top: 1px solid rgba(0,0,0,0.06);
            display: flex;
            gap: 8px;
            justify-content: space-between;
            align-items: center;
        }

        /* CHECKOUT FORM */
        .checkout-form {
            display: none;
            flex-direction: column;
            gap: 10px;
        }

        .checkout-form input, .checkout-form textarea, .checkout-form select {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.08);
            font-size: 14px;
            width: 100%;
        }

        .small-note {
            font-size: 13px;
            color: rgba(0,0,0,0.6);
        }

        /* VARIANT POPUP */
        .variant-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .variant-popup {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: popupSlide 0.3s ease;
        }

        @keyframes popupSlide {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .variant-popup h3 {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .variant-section {
            margin-bottom: 25px;
        }

        .variant-section label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 15px;
        }

        .variant-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .variant-option {
            padding: 10px 16px;
            border: 2px solid rgba(0,0,0,0.1);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            background: white;
        }

        .variant-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .variant-option.selected {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
        }

        .variant-price-display {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary);
            margin: 20px 0;
            text-align: center;
        }

        .variant-qty {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .variant-qty button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .variant-qty button:hover {
            background: var(--primary);
            color: white;
        }

        .variant-qty span {
            font-size: 20px;
            font-weight: 600;
            min-width: 40px;
            text-align: center;
        }

        .variant-actions {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        .variant-actions button {
            flex: 1;
        }

        /* FOOTER */
        footer {
            background: rgba(26, 15, 8, 0.9);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
        }

        footer .social {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        footer .social a {
            color: rgba(255, 255, 255, 0.6);
            font-size: 24px;
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .products { grid-template-columns: 1fr; gap: 20px; }
            header.hero { min-height: 50vh; padding: 20px 15px 40px; }
            .modal { right: 10px; left: 10px; bottom: 60px; width: auto; max-width: calc(100vw - 20px); }
            .cart-fab { right: 16px; bottom: 16px; }
            .variant-popup { padding: 20px; }
        }
    </style>
</head>

<body>
    <!-- NAVBAR -->
    <nav>
        <div class="brand">Padhendoet Streetfood</div>
        <div class="menu">
            <a href="#">Home</a>
            <a href="#produk">Produk</a>
            <a href="#about">About</a>
        </div>
    </nav>

    <!-- HERO -->
    <header class="hero">
        <h1>Selamat Datang di Padhendoet Streetfood üç¥</h1>
        <p>Cemilan kekinian ‚Äì digitalized UMKM. Order mudah via Quick Order & WhatsApp.</p>
        <a href="#produk" class="cta-btn">üçî Lihat Menu Kami</a>
    </header>

    <!-- BODY PRODUK -->
    <section id="produk" class="container">
        <div class="section-title">
            <h2>Menu Spesial Kami</h2>
            <p>Pilihan terbaik cemilan kekinian dengan cita rasa autentik</p>
        </div>
        <div class="products" id="productGrid"></div>
    </section>

    <!-- FOOTER -->
    <footer id="about">
        <p><strong>Wi-Food.zip</strong> - Inovasi UMKM Digital Terdepan</p>
        <p>Developed with ‚ù§Ô∏è ‚Ä¢ Demo Technopreneurship UPR</p>
        <div class="social">
            <a href="https://wa.me/6282254305100"><i class="fab fa-whatsapp"></i></a>
            <a href="https://www.instagram.com/wifood.zip/?utm_source=ig_web_button_share_sheet"><i
                    class="fab fa-instagram"></i></a>
        </div>
    </footer>

    <!-- CART FLOAT BUTTON -->
    <div class="cart-fab" id="cartFab" title="Lihat Keranjang">
        <i class="fas fa-shopping-cart" style="font-size:20px;"></i>
        <div class="cart-count" id="cartCount" style="display:none">0</div>
    </div>

    <!-- CART MODAL -->
    <div class="modal" id="cartModal" aria-hidden="true">
        <header>
            <span>üõí Keranjang Anda</span>
            <button id="closeCart" class="btn secondary" style="padding:8px 10px;"><i class="fas fa-times"></i></button>
        </header>
        <div class="content" id="cartContent">
            <div class="small-note">Keranjang kosong.</div>
        </div>

        <div style="padding:0 16px 12px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                <div><b>Total</b></div>
                <div><b id="cartTotal">Rp 0</b></div>
            </div>
            <div style="display:flex;gap:8px;">
                <button id="btnCheckout" class="btn" style="flex:1">Checkout</button>
                <button id="btnClear" class="btn secondary" style="flex:1">Kosongkan</button>
            </div>
        </div>

        <!-- Checkout form -->
        <div class="content" id="checkoutArea" style="display:none; border-top:1px solid rgba(0,0,0,0.06);">
            <div class="checkout-form" id="checkoutForm">
                <div>
                    <label>Nama <span style="color:red">*</span></label>
                    <input type="text" id="custName" placeholder="Nama lengkap" />
                </div>
                <div>
                    <label>Nomor HP <span style="color:red">*</span></label>
                    <input type="text" id="custPhone" placeholder="ex: 08123456789" />
                </div>
                <div>
                    <label>Alamat</label>
                    <textarea id="custAddress" rows="2" placeholder="Alamat pengiriman (opsional)"></textarea>
                </div>
                <div>
                    <label>Pembayaran</label>
                    <select id="paymentMethod">
                        <option value="Tunai">Tunai (Bayar di tempat)</option>
                        <option value="Non-tunai">Non-tunai (Transfer / E-wallet)</option>
                    </select>
                </div>
                <div id="paymentDetailContainer" style="display:none;">
                    <label>Detail Pembayaran (opsional)</label>
                    <input id="paymentDetail" placeholder="Mis. Transfer BRI a/n ... / e-wallet: ... / no ref" />
                </div>
                <div style="display:flex;gap:8px;margin-top:8px;">
                    <button id="confirmOrder" class="btn" style="flex:1">Konfirmasi & Kirim ke WhatsApp</button>
                    <button id="backToCart" class="btn secondary" style="flex:1">Kembali</button>
                </div>
                <p class="small-note" style="margin-top:8px;">Setelah konfirmasi, WhatsApp akan terbuka dengan pesan pesanan.</p>
            </div>
        </div>
    </div>

    <!-- VARIANT POPUP -->
    <div class="variant-overlay" id="variantOverlay">
        <div class="variant-popup" id="variantPopup">
            <h3 id="variantTitle">üç¢ Pilih Varian</h3>
            
            <div class="variant-section">
                <label>Ukuran:</label>
                <div class="variant-options" id="sizeOptions"></div>
            </div>

            <div class="variant-section">
                <label>Rasa:</label>
                <div class="variant-options" id="flavorOptions"></div>
            </div>

            <div class="variant-price-display" id="variantPriceDisplay">Rp 0</div>

            <div class="variant-section">
                <label>Jumlah:</label>
                <div class="variant-qty">
                    <button id="variantQtyMinus">-</button>
                    <span id="variantQtyValue">1</span>
                    <button id="variantQtyPlus">+</button>
                </div>
            </div>

            <div class="variant-actions">
                <button class="btn" id="variantAddToCart"><i class="fas fa-cart-plus"></i> Tambah ke Keranjang</button>
                <button class="btn secondary" id="variantCancel">Batal</button>
            </div>
        </div>
    </div>

    <script>
        // === KONFIGURASI ===
        const WHATSAPP_NUMBER = '6282254305100';

        // === PRODUK ===
        const PRODUCTS = [
            { id: 'WiCheez', label: 'WiCheez (Ayam Keju)', desc: 'Ayam gurih dengan keju lezat yang meleleh di mulut.', price: 15000 },
            { id: 'WiTea', label: 'WiTea (Teh Es)', desc: 'Teh manis segar pelepas dahaga dengan rasa autentik.', price: 5000 },
            { 
                id: 'WiMol', 
                label: 'WiMol (Cimol)', 
                desc: 'Cimol kenyal gurih dengan bumbu rahasia keluarga.',
                hasVariants: true,
                variants: {
                    sizes: [
                        { id: 'kecil', label: 'Kecil', price: 5000 },
                        { id: 'sedang', label: 'Sedang', price: 10000 },
                        { id: 'besar', label: 'Besar', price: 15000 }
                    ],
                    flavors: [
                        { id: 'pedas-manis', label: 'Pedas Manis' },
                        { id: 'pedas-asin', label: 'Pedas Asin' },
                        { id: 'manis', label: 'Manis' },
                        { id: 'jagung-bakar', label: 'Jagung Bakar' },
                        { id: 'barbeque', label: 'Barbeque' }
                    ]
                }
            },
            { id: 'WiSum', label: 'WiSum (Dimsum)', desc: 'Dimsum hangat dengan saus spesial yang menggugah selera.', price: 20000 },
            { 
                id: 'WiClok', 
                label: 'WiClok (Cilok)', 
                desc: 'Cilok legend dengan bumbu kacang khas yang tak terlupakan.',
                hasVariants: true,
                variants: {
                    sizes: [
                        { id: 'kecil', label: 'Kecil', price: 5000 },
                        { id: 'besar', label: 'Besar', price: 10000 }
                    ],
                    flavors: [
                        { id: 'kacang-pedas', label: 'Kacang Pedas' },
                        { id: 'kacang-manis', label: 'Kacang Manis' },
                        { id: 'sambal-jeletot', label: 'Sambal Jeletot' }
                    ]
                }
            },
            { id: 'WiSpicy', label: 'WiSpicy (Pangsit Pedas)', desc: 'Pangsit renyah pedas gurih dengan level kepedasan yang bisa disesuaikan.', price: 12000 }
        ];

        // === STATE ===
        let cart = [];
        let currentVariantProduct = null;
        let selectedSize = null;
        let selectedFlavor = null;
        let variantQty = 1;

        // === RENDER PRODUK ===
        const grid = document.getElementById('productGrid');
        function renderProducts() {
            grid.innerHTML = '<div style="text-align:center;color:white;"><div class="loading"></div><br>Memuat menu...</div>';
            setTimeout(() => {
                grid.innerHTML = PRODUCTS.map((p, index) => {
                    const priceDisplay = p.hasVariants ? 
                        `Mulai dari Rp ${Math.min(...p.variants.sizes.map(s => s.price)).toLocaleString('id')}` :
                        `Rp ${p.price.toLocaleString('id')}`;
                    
                    return `
                    <div class="card" style="animation-delay:${index*0.05}s">
                        <img src="img/${p.id}.jpg" alt="${p.label}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkZGNUYwIi8+CjxjaXJjbGUgY3g9IjE1MCIgY3k9IjEwMCIgcj0iNDAiIGZpbGw9IiNGRjZCMzUiIG9wYWNpdHk9IjAuMyIvPgo8dGV4dCB4PSIxNTAiIHk9IjEwNSIgZmlsbD0iI0ZGNkIzNSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+8J+NtDwvdGV4dD4KPHR0ZXh0IHg9IjE1MCIgeT0iMTMwIiBmaWxsPSIjRkY2QjM1IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkZvb2QgSW1hZ2U8L3RleHQ+Cjwvc3ZnPg=='">
                        <h3>${p.label}</h3>
                        <p>${p.desc}</p>
                                                <div class="price">${p.hasVariants ? `Mulai dari Rp ${Math.min(...p.variants.sizes.map(s => s.price)).toLocaleString('id')}` : `Rp ${p.price.toLocaleString('id')}`}</div>
                        <div style="display:flex;gap:8px;align-items:center;">
                            <button class="btn" onclick="addToCartPrompt('${p.id}')"><i class="fas fa-plus"></i> Tambah</button>
                            <button class="btn secondary" onclick="quickBuy('${p.id}')"><i class="fas fa-bolt"></i> Beli Sekarang</button>
                        </div>
                    </div>
                `;
                }).join("");
            }, 300);
        }

        renderProducts();

        // === CART UI REFERENCES ===
        const cartFab = document.getElementById('cartFab');
        const cartCountEl = document.getElementById('cartCount');
        const cartModal = document.getElementById('cartModal');
        const cartContent = document.getElementById('cartContent');
        const cartTotalEl = document.getElementById('cartTotal');
        const btnClear = document.getElementById('btnClear');
        const btnCheckout = document.getElementById('btnCheckout');
        const checkoutArea = document.getElementById('checkoutArea');
        const checkoutForm = document.getElementById('checkoutForm');
        const backToCart = document.getElementById('backToCart');
        const confirmOrder = document.getElementById('confirmOrder');
        const closeCart = document.getElementById('closeCart');

        // variant overlay elements
        const variantOverlay = document.getElementById('variantOverlay');
        const variantTitle = document.getElementById('variantTitle');
        const sizeOptionsEl = document.getElementById('sizeOptions');
        const flavorOptionsEl = document.getElementById('flavorOptions');
        const variantPriceDisplay = document.getElementById('variantPriceDisplay');
        const variantQtyMinus = document.getElementById('variantQtyMinus');
        const variantQtyPlus = document.getElementById('variantQtyPlus');
        const variantQtyValue = document.getElementById('variantQtyValue');
        const variantAddToCart = document.getElementById('variantAddToCart');
        const variantCancel = document.getElementById('variantCancel');

        // EVENT LISTENERS
        cartFab.addEventListener('click', toggleCartModal);
        closeCart.addEventListener('click', closeCartModal);
        btnClear.addEventListener('click', () => { if (confirm('Kosongkan seluruh keranjang?')) { cart = []; renderCart(); } });
        btnCheckout.addEventListener('click', openCheckout);
        backToCart.addEventListener('click', () => { checkoutArea.style.display = 'none'; cartContent.style.display = 'block'; });
        confirmOrder.addEventListener('click', doCheckout);

        variantQtyMinus.addEventListener('click', () => {
            if (variantQty > 1) { variantQty--; document.getElementById('variantQtyValue').innerText = variantQty; updateVariantPrice(); }
        });
        variantQtyPlus.addEventListener('click', () => { variantQty++; document.getElementById('variantQtyValue').innerText = variantQty; updateVariantPrice(); });
        variantAddToCart.addEventListener('click', () => { confirmVariant(); });
        variantCancel.addEventListener('click', () => { closeVariantModal(); });

        // === HELPERS & MAIN LOGIC ===

        function toggleCartModal() {
            const visible = cartModal.style.display === 'flex';
            if (visible) closeCartModal(); else openCartModal();
        }
        function openCartModal() {
            cartModal.style.display = 'flex';
            cartContent.style.display = 'block';
            checkoutArea.style.display = 'none';
            renderCart();
        }
        function closeCartModal() {
            cartModal.style.display = 'none';
        }

        // Add to cart (for non-variant items)
        function addToCartPrompt(productId) {
            const p = PRODUCTS.find(x => x.id === productId);
            if (!p) return;
            if (p.hasVariants) {
                openVariantModal(productId);
                return;
            }

            // ask jumlah sederhana (konsisten dengan kode awal)
            let qty = prompt('Masukkan jumlah (angka):', '1');
            if (qty === null) return;
            qty = parseInt(qty, 10);
            if (!Number.isInteger(qty) || qty <= 0) { alert('Jumlah tidak valid.'); return; }

            addToCart({
                productId: p.id,
                label: p.label,
                price: p.price,
                qty
            });
            openCartModal();
        }

        function quickBuy(productId) {
            const p = PRODUCTS.find(x => x.id === productId);
            if (!p) return;
            if (p.hasVariants) {
                // langsung buka variant modal dengan qty 1
                openVariantModal(productId);
                return;
            }
            cart = [];
            addToCart({
                productId: p.id,
                label: p.label,
                price: p.price,
                qty: 1
            });
            openCartModal();
            setTimeout(openCheckout, 200);
        }

        function addToCart(item) {
            // item: { productId, label, price, qty, variantSize?, variantFlavor? }
            // Jika ada item serupa (sama productId + same variant), tambahkan qty
            const sameIndex = cart.findIndex(ci => {
                if (ci.productId !== item.productId) return false;
                // compare variant if present
                if ((ci.variantSize || '') !== (item.variantSize || '')) return false;
                if ((ci.variantFlavor || '') !== (item.variantFlavor || '')) return false;
                return true;
            });

            if (sameIndex >= 0) {
                cart[sameIndex].qty += item.qty;
            } else {
                cart.push(item);
            }
            renderCart();
        }

        function renderCart() {
            // update badge
            const totalItems = cart.reduce((s, it) => s + it.qty, 0);
            if (totalItems > 0) {
                cartCountEl.style.display = 'flex';
                cartCountEl.innerText = totalItems;
            } else {
                cartCountEl.style.display = 'none';
            }

            if (cart.length === 0) {
                cartContent.innerHTML = '<div class="small-note">Keranjang kosong.</div>';
                cartTotalEl.innerText = 'Rp 0';
                return;
            }

            let total = 0;
            cartContent.innerHTML = '';
            cart.forEach((item, idx) => {
                const sub = item.price * item.qty;
                total += sub;

                const node = document.createElement('div');
                node.className = 'cart-item';
                node.innerHTML = `
                    <img src="img/${item.productId}.jpg" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCI+PHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRkY2QjM1Ii8+PHRleHQgeD0iMzIiIHk9IjM2IiBmb250LXNpemU9IjEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjRkY2QjM1Ij4gPC90ZXh0Pjwvc3ZnPg=='">
                `;
                const meta = document.createElement('div');
                meta.className = 'meta';
                meta.innerHTML = `
    <b>${item.label}</b>
    ${item.variantSize ? `<div>Ukuran: ${item.variantSize}</div>` : ''}
    ${item.variantFlavor ? `<div>Rasa: ${item.variantFlavor}</div>` : ''}
    <div>Rp ${item.price.toLocaleString('id')} x ${item.qty}</div>
    <div style="margin-top:6px;color:rgba(0,0,0,0.6)">
        Subtotal: Rp ${(item.price * item.qty).toLocaleString('id')}
    </div>`;

                const actions = document.createElement('div');
                actions.className = 'actions';

                // qty control
                const qtyCtrl = document.createElement('div');
                qtyCtrl.className = 'qty-control';
                qtyCtrl.innerHTML = `<button onclick="changeQty(${idx}, -1)">-</button><div style="min-width:28px;text-align:center">${item.qty}</div><button onclick="changeQty(${idx}, 1)">+</button>`;

                const delBtn = document.createElement('button');
                delBtn.className = 'btn secondary';
                delBtn.style.padding = '6px 8px';
                delBtn.innerHTML = '<i class="fas fa-trash"></i>';
                delBtn.onclick = () => { if (confirm('Hapus item ini?')) { cart.splice(idx,1); renderCart(); } };

                actions.appendChild(qtyCtrl);
                actions.appendChild(delBtn);

                node.appendChild(meta);
                node.appendChild(actions);
                cartContent.appendChild(node);
            });

            cartTotalEl.innerText = 'Rp ' + total.toLocaleString('id');
        }

        function changeQty(index, delta) {
            if (!cart[index]) return;
            cart[index].qty += delta;
            if (cart[index].qty <= 0) {
                if (confirm('Jumlah 0 ‚Äî hapus item?')) {
                    cart.splice(index, 1);
                } else {
                    cart[index].qty = 1;
                }
            }
            renderCart();
        }

        // OPEN CHECKOUT (show form)
        function openCheckout() {
            if (cart.length === 0) { alert('Keranjang kosong. Tambah produk terlebih dahulu.'); return; }
            cartContent.style.display = 'none';
            checkoutArea.style.display = 'block';
            document.getElementById('checkoutForm').style.display = 'flex';
            // reset form fields
            document.getElementById('custName').value = '';
            document.getElementById('custPhone').value = '';
            document.getElementById('custAddress').value = '';
            document.getElementById('paymentMethod').value = 'Tunai';
            document.getElementById('paymentDetailContainer').style.display = 'none';
            document.getElementById('paymentDetail').value = '';
        }

        // PAYMENT detail toggle
        document.getElementById('paymentMethod').addEventListener('change', (e) => {
            if (e.target.value === 'Non-tunai') document.getElementById('paymentDetailContainer').style.display = 'block';
            else document.getElementById('paymentDetailContainer').style.display = 'none';
        });

        // BUILD & SEND ORDER VIA WHATSAPP
        function doCheckout() {
            const name = document.getElementById('custName').value.trim();
            const phone = document.getElementById('custPhone').value.trim();
            const address = document.getElementById('custAddress').value.trim();
            const paymentMethod = document.getElementById('paymentMethod').value;
            const paymentDetail = document.getElementById('paymentDetail').value.trim();

            if (!name) { alert('Isi nama terlebih dahulu.'); return; }
            if (!phone) { alert('Isi nomor HP terlebih dahulu.'); return; }

            let total = 0;
            const lines = cart.map(it => {
                total += it.price * it.qty;
                const varInfo = `${it.variantSize ? ' | Ukuran: ' + it.variantSize : ''}${it.variantFlavor ? ' | Rasa: ' + it.variantFlavor : ''}`;
                return `- ${it.label}${varInfo} x${it.qty} = Rp ${(it.price * it.qty).toLocaleString('id')}`;
            }).join('\n');

            let msg = `Halo Wi-Food.zip,\nSaya ingin memesan:\n${lines}\n\nTotal: Rp ${total.toLocaleString('id')}\n\nData Pemesan:\nNama: ${name}\nNo HP: ${phone}\nAlamat: ${address || '-'}\nMetode Pembayaran: ${paymentMethod}`;
            if (paymentDetail) msg += `\nDetail Pembayaran: ${paymentDetail}`;

            const waLink = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
            window.open(waLink, '_blank');

            // reset
            cart = [];
            renderCart();
            closeCartModal();
            alert('Pesanan dibuka di WhatsApp. Lengkapi dan kirim pesan di WhatsApp untuk menyelesaikan pesanan.');
        }

        // ========== VARIANT POPUP IMPLEMENTATION ==========
        function openVariantModal(productId) {
            const product = PRODUCTS.find(p => p.id === productId);
            if (!product) return;
            currentVariantProduct = product;
            selectedSize = null;
            selectedFlavor = null;
            variantQty = 1;
            document.getElementById('variantQtyValue').innerText = variantQty;

            // title
            document.getElementById('variantTitle').innerText = `üç¢ ${product.label} ‚Äî Pilih Varian`;

            // render size options
            sizeOptionsEl.innerHTML = '';
            product.variants.sizes.forEach((s, idx) => {
                const btn = document.createElement('button');
                btn.className = 'variant-option';
                btn.innerText = `${s.label} ‚Äî Rp ${s.price.toLocaleString('id')}`;
                btn.dataset.sizeId = s.id;
                btn.dataset.price = s.price;
                btn.addEventListener('click', () => {
                    // unselect siblings
                    Array.from(sizeOptionsEl.children).forEach(ch => ch.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedSize = s;
                    updateVariantPrice();
                });
                sizeOptionsEl.appendChild(btn);
                // auto-select first
                if (idx === 0) { btn.classList.add('selected'); selectedSize = s; }
            });

            // render flavor options
            flavorOptionsEl.innerHTML = '';
            product.variants.flavors.forEach((f, idx) => {
                const btn = document.createElement('button');
                btn.className = 'variant-option';
                btn.innerText = f.label;
                btn.dataset.flavorId = f.id;
                btn.addEventListener('click', () => {
                    Array.from(flavorOptionsEl.children).forEach(ch => ch.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedFlavor = f;
                });
                flavorOptionsEl.appendChild(btn);
                if (idx === 0) { btn.classList.add('selected'); selectedFlavor = f; }
            });

            updateVariantPrice();
            variantOverlay.style.display = 'flex';
        }

        function closeVariantModal() {
            variantOverlay.style.display = 'none';
        }

        function updateVariantPrice() {
            const price = selectedSize ? selectedSize.price * variantQty : 0;
            variantPriceDisplay.innerText = `Rp ${price.toLocaleString('id')}`;
            document.getElementById('variantQtyValue').innerText = variantQty;
        }

        function confirmVariant() {
            if (!currentVariantProduct) return;
            if (!selectedSize) { alert('Pilih ukuran terlebih dahulu.'); return; }
            if (!selectedFlavor) { alert('Pilih rasa terlebih dahulu.'); return; }

            const item = {
                productId: currentVariantProduct.id,
                label: currentVariantProduct.label,
                variantSize: selectedSize.label,
                variantFlavor: selectedFlavor.label,
                price: selectedSize.price,
                qty: variantQty
            };

            addToCart(item);
            closeVariantModal();
            openCartModal();
        }

        // ensure clicking overlay outside popup cancel
        variantOverlay.addEventListener('click', (e) => {
            if (e.target === variantOverlay) closeVariantModal();
        });

        // init variantQty display (already declared above)
        document.getElementById('variantQtyValue').innerText = variantQty;

        // END SCRIPT
    </script>
</body>
</html>

                        